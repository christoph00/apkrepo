# Contributor: Christoph Asche <christoph@asche.co>
# Maintainer: Christoph Asche <christoph@asche.co>
pkgname=homeassistant
pkgver=2022.5.5
pkgrel=0
pkgdesc="Open source home automation that puts local control and privacy first."
url="https://homeassistant.io"
arch="all"
license="Apache 2.0"
depends=
depends_dev="python3 sqlite-libs libffi-dev"
makedepends="$depends_dev"
install=
source="https://github.com/home-assistant/core/archive/refs/tags/$pkgver.tar.gz"

builddir="$srcdir"/$pkgname-$pkgver

wheels="https://wheels.home-assistant.io/alpine-3.14/${CARCH}"

prepare() {
	cd "$builddir"
	python3 -m venv venv
	
}

build() {
	./venv/bin/pip3 install --no-cache-dir --no-index --only-binary=:all: --find-links "${wheels}" -r requirements.txt --use-deprecated=legacy-resolver
	./venv/bin/pip3 install --no-cache-dir --no-index --only-binary=:all: --find-links "${wheels}" -r requirements_all.txt --use-deprecated=legacy-resolver
	./venv/bin/pip3 install --no-cache-dir --no-index --only-binary=:all: --find-links "${wheels}" -e . --use-deprecated=legacy-resolver
	./venv/bin/python3 -m compileall homeassistant
}

package() {

}

check() {

}
